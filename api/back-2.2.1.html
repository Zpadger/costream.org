

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>Initial scheduling and steady-state scheduling — COStream</title>
    <meta charset="utf-8">
    <meta name="description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link rel="alternate" hreflang="x-default" href="https://costream.site/api/back-2.2.1.html">
    <link rel="alternate" hreflang="zh" href="https://cn.costream.site/api/back-2.2.1.html">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Initial scheduling and steady-state scheduling — COStream">
    <meta property="og:description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta property="og:image" content="https://cn.costream.site/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Initial scheduling and steady-state scheduling — COStream">
    <meta name="twitter:description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta name="twitter:image" content="https://cn.costream.site/images/logo.png">

<!--
    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
-->
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
<!--
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
-->
    <meta name="msapplication-TileImage" content="/images/icons/favicon.png">
    <link rel="icon" href="/images/icons/favicon.png" type="image/png">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <!-- <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'> -->
    <!-- <link href='//fonts.googleapis.com/css?family=Dosis:500&text=Vue.js' rel='stylesheet' type='text/css'> -->

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script src="/js/vue.js"></script>
    <script>window.PAGE_TYPE = "api"</script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46852172-3', 'cn.costream.site');
      ga('send', 'pageview');
    </script>
  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/CO.svg">
    <span>COStream</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li>
    <a href="/guide/installation.html" class="nav-link team">Install</a>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
        <li><a href="/guide/" class="nav-link">Guide</a></li>
        <li><a href="/guide/grammar-book/grammar.html" class="nav-link">Grammar</a></li>
        <li><a href="/api/" class="nav-link current">Source</a></li>
      <li><a href="/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
        <li><a href="https://github.com/DML308/COStream/issues" class="nav-link" target="_blank">Forum</a></li>
    </ul></li>
    <li><h4>Tool</h4></li>
    <li>
      <ul>
        <li><a href="https://try.costream.site" class="nav-link" target="_blank"> Dev Online</a></li>
        <li><a href="https://costream.site" class="nav-link" target="_blank">Highlight Plugin</a></li>
      </ul>
    </li>
    <li><h4>Core Libraries</h4></li>
    <li><ul>
<!--    via 陈铭涛-->
      <li><a href="#" class="nav-link" target="_blank">GPU Computing</a></li>
<!--    via 李平然-->
      <li><a href="#" class="nav-link" target="_blank">Dynamic Scheduling</a></li>
<!--    via null-->
      <li><a href="#" class="nav-link" target="_blank">Gragh Partition</a></li>
    </ul></li>
    
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/DML308/COStream" class="nav-link" target="_blank">Official Repos</a></li>
    <li><h4>Associated Links</h4></li>
    <li><ul>
        <li><a href="http://www.hust.edu.cn" class="nav-link" target="_blank">HUST</a></li>
        <li><a href="http://media.hust.edu.cn" class="nav-link" target="_blank">DML</a></li>
        <li><a href="http://faculty.hust.edu.cn/yujunqing/zh_CN/index.htm" class="nav-link" target="_blank">Mater Enrollment</a></li>
        </ul></li> 
    </ul></li>
  </ul>
</li>

<li>
  <a href="/guide/team.html" class="nav-link team">Team</a>
</li>
<!--
<li>
    <a href="#" class="nav-link team">团队</a>
</li>
-->
<li class="nav-dropdown-container language">
  <a class="nav-link">Language</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://costream.site/api/back-2.2.1.html" class="nav-link" target="_blank">English</a></li>
    <li><a href="https://cn.costream.site/api/back-2.2.1.html" class="nav-link" target="_blank">简体中文</a></li>
  </ul>
</li>

<!--<li><a href="https://github.com/vuejs/cn.vuejs.org/" target="_blank" class="nav-link contribute">参与翻译</a></li>-->

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li>
    <a href="/guide/installation.html" class="nav-link team">Install</a>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
        <li><a href="/guide/" class="nav-link">Guide</a></li>
        <li><a href="/guide/grammar-book/grammar.html" class="nav-link">Grammar</a></li>
        <li><a href="/api/" class="nav-link current">Source</a></li>
      <li><a href="/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
        <li><a href="https://github.com/DML308/COStream/issues" class="nav-link" target="_blank">Forum</a></li>
    </ul></li>
    <li><h4>Tool</h4></li>
    <li>
      <ul>
        <li><a href="https://try.costream.site" class="nav-link" target="_blank"> Dev Online</a></li>
        <li><a href="https://costream.site" class="nav-link" target="_blank">Highlight Plugin</a></li>
      </ul>
    </li>
    <li><h4>Core Libraries</h4></li>
    <li><ul>
<!--    via 陈铭涛-->
      <li><a href="#" class="nav-link" target="_blank">GPU Computing</a></li>
<!--    via 李平然-->
      <li><a href="#" class="nav-link" target="_blank">Dynamic Scheduling</a></li>
<!--    via null-->
      <li><a href="#" class="nav-link" target="_blank">Gragh Partition</a></li>
    </ul></li>
    
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/DML308/COStream" class="nav-link" target="_blank">Official Repos</a></li>
    <li><h4>Associated Links</h4></li>
    <li><ul>
        <li><a href="http://www.hust.edu.cn" class="nav-link" target="_blank">HUST</a></li>
        <li><a href="http://media.hust.edu.cn" class="nav-link" target="_blank">DML</a></li>
        <li><a href="http://faculty.hust.edu.cn/yujunqing/zh_CN/index.htm" class="nav-link" target="_blank">Mater Enrollment</a></li>
        </ul></li> 
    </ul></li>
  </ul>
</li>

<li>
  <a href="/guide/team.html" class="nav-link team">Team</a>
</li>
<!--
<li>
    <a href="#" class="nav-link team">团队</a>
</li>
-->
<li class="nav-dropdown-container language">
  <a class="nav-link">Language</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://costream.site/api/back-2.2.1.html" class="nav-link" target="_blank">English</a></li>
    <li><a href="https://cn.costream.site/api/back-2.2.1.html" class="nav-link" target="_blank">简体中文</a></li>
  </ul>
</li>

<!--<li><a href="https://github.com/vuejs/cn.vuejs.org/" target="_blank" class="nav-link contribute">参与翻译</a></li>-->

    </ul>
    <div class="list">
      
      
        <h2>
          
          Source Explain
<!--
          
            <select class="version-select">
              <option value="SELF" selected>2.x</option>
              <option value="v1">1.0</option>
              <option value="012">0.12</option>
              <option value="011">0.11</option>
            </select>
          
-->
        </h2>
        <ul class="menu-root">
  
    
    
    
	
	
    
    <li>
      <a href="/api/index.html" class="sidebar-link">Overview</a>
    </li>
  
    
    
    
	
      <li><h3>Front end - Parser </h3></li>
      
	
    
    <li>
      <a href="/api/front-2.1.0.html" class="sidebar-link">Get & preprocess Input file</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.1.html" class="sidebar-link">Preprocessing & Environment initialization</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.2.html" class="sidebar-link">Grammar creation and grammar tree generation</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.3.html" class="sidebar-link">Print symbol table</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.4.html" class="sidebar-link">Delete file & verifies the Lexical and grammatical analysis results</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.5.html" class="sidebar-link">Semantic check</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.7.html" class="sidebar-link">Variable rename</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.8.html" class="sidebar-link">Constant propagation</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.9.html" class="sidebar-link">Print AST</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.11.html" class="sidebar-link">Estimate workload of  nodes in flatgraph</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/front-2.1.10.html" class="sidebar-link">AST to Flatgraph</a>
    </li>
  
    
    
    
	
	
      <li><h3>Back end - CodeGenerator</h3></li>
      
    
    <li>
      <a href="/api/back-2.2.1.html" class="sidebar-link current">Initial scheduling and steady-state scheduling</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/back-2.2.2.html" class="sidebar-link">Describe the SDF diagram in the form of XML</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/back-2.2.3.html" class="sidebar-link">Parition graph</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/back-2.2.4.html" class="sidebar-link">Print theoretical speedup ratio</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/back-2.2.5.html" class="sidebar-link">Stage Assignment</a>
    </li>
  
    
    
    
	
	
    
    <li>
      <a href="/api/back-2.2.6.html" class="sidebar-link">Code Generation</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>


<div class="content api with-sidebar ">
  
    
  
  
    <h1>Initial scheduling and steady-state scheduling</h1>
  
  
    <p>From the syntax tree to the flatgraph at the front-end，wo get the Static Stream Graph(SSG) and estimate the workload. In the back-end of the complier，we process the the flat graph.</p>
<h2 id="Program-Entrance"><a href="#Program-Entrance" class="headerlink" title="Program Entrance"></a>Program Entrance</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// （1）The first is initial scheduling and steady-state scheduling of the SSG， SSG is transformed form the syntax tree at step(10) in the front-end</span></span><br><span class="line">PhaseName = <span class="string">"schedulerSSG"</span>;</span><br><span class="line"><span class="keyword">if</span> (Errors == <span class="number">0</span> &amp;&amp; SchedulingFlatSSG)</span><br><span class="line">    SSSG = SchedulingSSG(SSG);</span><br></pre></td></tr></table></figure>
<ul>
<li>Variable <code>PhaseName</code> is the Stage name，the value is <code>schedulerSSG (scheduler static stream graph)</code></li>
<li><code>schedulingFlatSSG</code> is the switch of scheduling flatgraph，which type is Global Bool,and it is defined in the main.cpp source file</li>
<li>The program entry is the function<code>SchedulingSSG(SSG)</code>，the input is the SSG ,and the output is the SSSG which finish the scheduling.</li>
</ul>
<h2 id="Associated-file"><a href="#Associated-file" class="headerlink" title="Associated file"></a>Associated file</h2><p>(1)    staticStreamGraph.h and  staticStreamGraph.cpp  see 2.1.10<br>(2)    schedulerSSG.h class schedulerSSG：This class inherits from StaticStreamGraph</p>
<table>
<thead>
<tr>
<th style="text-align:left">Name</th>
<th style="text-align:left">Descritpion</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>map&lt;FlatNode * node, int initcount&gt;</code><br><code>mapInitCount2FlatNode</code></td>
<td style="text-align:left">store the initial scheduling result of all nodes in SDF graph</td>
</tr>
<tr>
<td style="text-align:left"><code>map&lt;FlatNode* node,int steadycount&gt;</code><br><code>mapSteadyCount2FlatNode</code></td>
<td style="text-align:left">store the steady scheduling result of all nodes in SDF graph</td>
</tr>
<tr>
<td style="text-align:left"><code>SchedulerSSG(StaticStreamGraph *ssg)</code></td>
<td style="text-align:left">Constructor</td>
</tr>
<tr>
<td style="text-align:left"><code>bool InitScheduling()</code></td>
<td style="text-align:left">initial schedule the SSG</td>
</tr>
<tr>
<td style="text-align:left"><code>boolSteadyScheduling()</code></td>
<td style="text-align:left">steady-state schedule the SSG</td>
</tr>
<tr>
<td style="text-align:left"><code>int GetInitCount(FlatNode *node)</code></td>
<td style="text-align:left">get Initcount of a node</td>
</tr>
<tr>
<td style="text-align:left"><code>bool GetSteadyCount(FlatNode *node)</code></td>
<td style="text-align:left">get steadycount of a node</td>
</tr>
<tr>
<td style="text-align:left"><code>map&lt;FlatNode *,int&gt;</code><br><code>SteadySchedulingGroup(Vector &lt;FlatNode *&gt;)</code></td>
<td style="text-align:left">do steady scheduling to a group of nodes</td>
</tr>
</tbody>
</table>
<p>The implememtation code is in source file schedulerSSG.cpp</p>
<p>(3)    schedule.cpp<br>This cpp file is an implementation file designed to handle the dispatch entry function. The actor in SDF is executed periodically. The periodic scheduling calculates the number of times each actor needs to be executed repeatedly when SDF completes a complete execution, that is, the number of steady-state executions of the actor. The sequence of steady-state execution times of all actors is the SDF graph steady state. Scheduling. Only the actor nodes in the SDF have reached the steady-state scheduling, and the next processing steps can be smoothly carried out to achieve the final code generation.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">GLOBAL SchedulerSSG *<span class="title">SchedulingSSG</span><span class="params">(StaticStreamGraph *ssg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SchedulerSSG *sssg = <span class="keyword">new</span> SchedulerSSG(ssg);</span><br><span class="line">    <span class="comment">//do SteadyScheduling to sssg, if success return true</span></span><br><span class="line">    <span class="keyword">if</span>(sssg-&gt;SteadyScheduling())</span><br><span class="line">    &#123;</span><br><span class="line">        sssg-&gt;InitScheduling();		</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">" The program does not have steady state scheduling , cannot generate code.！\n"</span>);</span><br><span class="line">        system(<span class="string">"pause"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;<span class="comment">//else</span></span><br><span class="line">    <span class="keyword">return</span> sssg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The above code is the implementation of the scheduling , it’s very clear。</p>
<ul>
<li>The input is the SSG.</li>
<li>The output is the SSSG which finish the scheduling.</li>
</ul>
<h3 id="Initial-state-scheduling-flow-chart"><a href="#Initial-state-scheduling-flow-chart" class="headerlink" title="Initial-state scheduling flow chart"></a>Initial-state scheduling flow chart</h3><p><img src="/img/initScheduling.png" alt="Initial-state scheduling flow chart"></p>
<h3 id="Steady-state-scheduling-flow-chart"><a href="#Steady-state-scheduling-flow-chart" class="headerlink" title="Steady-state scheduling flow chart"></a>Steady-state scheduling flow chart</h3><p><img src="/img/steadyScheduling.png" alt="Steady-state scheduling flow chart"></p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Why-is-the-scheduling-order-first-steady-state-and-initial-state"><a href="#Why-is-the-scheduling-order-first-steady-state-and-initial-state" class="headerlink" title="Why is the scheduling order first steady state and initial state?"></a>Why is the scheduling order first steady state and initial state?</h3><ul>
<li>Steady-state scheduling processes the amount of data from the top-down node to reach equilibrium</li>
<li>The initial state schedules the amount of data from the bottom-up processing node to reach equilibrium            </li>
<li>The initial scheduling and the steady scheduling are independent of each other</li>
<li>Usually the steady state must exist.If the steady state does not exist, the program cannot run, and the initial state may not exist.</li>
<li>Function SteadyScheduling()determines whether the SDF can reach steady state；</li>
<li>Reduce the memory overhead by avoidable InitScheduling() function calls<h3 id="What-does-the-initial-state-and-steady-state-scheduling-do-for-the-SDF-diagram"><a href="#What-does-the-initial-state-and-steady-state-scheduling-do-for-the-SDF-diagram" class="headerlink" title="What does the initial state and steady state scheduling do for the SDF diagram?"></a>What does the initial state and steady state scheduling do for the SDF diagram?</h3></li>
<li>Did not change the structural characteristics of the SDF</li>
<li>Just calculate how the data filling the SDF graph (sssg)</li>
</ul>

  
  
  <div class="footer">
	Caught a mistake or want to contribute to the documentation? 
    	
	  <a href="https://github.com/DML308/costream.org/tree/master/src/api/back-2.2.1.md" target="_blank">
		  Edit this page on GitHub!
	  </a>
  	
  </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>

    <!-- search -->
    <link href="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/search.css">
    <script src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
    [
      '#search-query-nav',
      '#search-query-sidebar',
      '#search-query-menu'
    ].forEach(function (selector) {
      if (!document.querySelector(selector)) return
      // search index defaults to v2
      var match = window.location.pathname.match(/^\/(v\d+)/)
      var version = match ? match[1] : 'v2'
      docsearch({
      appId: 'BH4D9OD16A',
      apiKey: '5638280abff9d207417bb03be05f0b25',
      indexName: 'vuejs_cn2',
      inputSelector: selector,
      algoliaOptions: { facetFilters: ["version:" + version] }
      })
    })
    </script>

    <!-- fastclick -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
    </script>
  </body>
</html>
