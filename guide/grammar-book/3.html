

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>Streaming Data Process — COStream</title>
    <meta charset="utf-8">
    <meta name="description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link rel="alternate" hreflang="x-default" href="https://costream.site/guide/grammar-book/3.html">
    <link rel="alternate" hreflang="zh" href="https://cn.costream.site/guide/grammar-book/3.html">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Streaming Data Process — COStream">
    <meta property="og:description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta property="og:image" content="https://cn.costream.site/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Streaming Data Process — COStream">
    <meta name="twitter:description" content="COStream - The High Performance Dataflow Language and Compiler">
    <meta name="twitter:image" content="https://cn.costream.site/images/logo.png">

<!--
    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
-->
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
<!--
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
-->
    <meta name="msapplication-TileImage" content="/images/icons/favicon.png">
    <link rel="icon" href="/images/icons/favicon.png" type="image/png">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <!-- <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'> -->
    <!-- <link href='//fonts.googleapis.com/css?family=Dosis:500&text=Vue.js' rel='stylesheet' type='text/css'> -->

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script src="/js/vue.js"></script>
    <script>window.PAGE_TYPE = "guide"</script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46852172-3', 'cn.costream.site');
      ga('send', 'pageview');
    </script>
  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/CO.svg">
    <span>COStream</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li>
    <a href="/guide/installation.html" class="nav-link team">Install</a>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
        <li><a href="/guide/" class="nav-link">Guide</a></li>
        <li><a href="/guide/grammar-book/grammar.html" class="nav-link current">Grammar</a></li>
        <li><a href="/api/" class="nav-link">Source</a></li>
      <li><a href="/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
        <li><a href="https://github.com/DML308/COStream/issues" class="nav-link" target="_blank">Forum</a></li>
    </ul></li>
    <li><h4>Tool</h4></li>
    <li>
      <ul>
        <li><a href="https://try.costream.site" class="nav-link" target="_blank"> Dev Online</a></li>
        <li><a href="https://costream.site" class="nav-link" target="_blank">Highlight Plugin</a></li>
      </ul>
    </li>
    <li><h4>Core Libraries</h4></li>
    <li><ul>
<!--    via 陈铭涛-->
      <li><a href="#" class="nav-link" target="_blank">GPU Computing</a></li>
<!--    via 李平然-->
      <li><a href="#" class="nav-link" target="_blank">Dynamic Scheduling</a></li>
<!--    via null-->
      <li><a href="#" class="nav-link" target="_blank">Gragh Partition</a></li>
    </ul></li>
    
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/DML308/COStream" class="nav-link" target="_blank">Official Repos</a></li>
    <li><h4>Associated Links</h4></li>
    <li><ul>
        <li><a href="http://www.hust.edu.cn" class="nav-link" target="_blank">HUST</a></li>
        <li><a href="http://media.hust.edu.cn" class="nav-link" target="_blank">DML</a></li>
        <li><a href="http://faculty.hust.edu.cn/yujunqing/zh_CN/index.htm" class="nav-link" target="_blank">Mater Enrollment</a></li>
        </ul></li> 
    </ul></li>
  </ul>
</li>

<li>
  <a href="/guide/team.html" class="nav-link team">Team</a>
</li>
<!--
<li>
    <a href="#" class="nav-link team">团队</a>
</li>
-->
<li class="nav-dropdown-container language">
  <a class="nav-link">Language</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://costream.site/guide/grammar-book/3.html" class="nav-link" target="_blank">English</a></li>
    <li><a href="https://cn.costream.site/guide/grammar-book/3.html" class="nav-link" target="_blank">简体中文</a></li>
  </ul>
</li>

<!--<li><a href="https://github.com/vuejs/cn.vuejs.org/" target="_blank" class="nav-link contribute">参与翻译</a></li>-->

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li>
    <a href="/guide/installation.html" class="nav-link team">Install</a>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
        <li><a href="/guide/" class="nav-link">Guide</a></li>
        <li><a href="/guide/grammar-book/grammar.html" class="nav-link current">Grammar</a></li>
        <li><a href="/api/" class="nav-link">Source</a></li>
      <li><a href="/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
        <li><a href="https://github.com/DML308/COStream/issues" class="nav-link" target="_blank">Forum</a></li>
    </ul></li>
    <li><h4>Tool</h4></li>
    <li>
      <ul>
        <li><a href="https://try.costream.site" class="nav-link" target="_blank"> Dev Online</a></li>
        <li><a href="https://costream.site" class="nav-link" target="_blank">Highlight Plugin</a></li>
      </ul>
    </li>
    <li><h4>Core Libraries</h4></li>
    <li><ul>
<!--    via 陈铭涛-->
      <li><a href="#" class="nav-link" target="_blank">GPU Computing</a></li>
<!--    via 李平然-->
      <li><a href="#" class="nav-link" target="_blank">Dynamic Scheduling</a></li>
<!--    via null-->
      <li><a href="#" class="nav-link" target="_blank">Gragh Partition</a></li>
    </ul></li>
    
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/DML308/COStream" class="nav-link" target="_blank">Official Repos</a></li>
    <li><h4>Associated Links</h4></li>
    <li><ul>
        <li><a href="http://www.hust.edu.cn" class="nav-link" target="_blank">HUST</a></li>
        <li><a href="http://media.hust.edu.cn" class="nav-link" target="_blank">DML</a></li>
        <li><a href="http://faculty.hust.edu.cn/yujunqing/zh_CN/index.htm" class="nav-link" target="_blank">Mater Enrollment</a></li>
        </ul></li> 
    </ul></li>
  </ul>
</li>

<li>
  <a href="/guide/team.html" class="nav-link team">Team</a>
</li>
<!--
<li>
    <a href="#" class="nav-link team">团队</a>
</li>
-->
<li class="nav-dropdown-container language">
  <a class="nav-link">Language</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://costream.site/guide/grammar-book/3.html" class="nav-link" target="_blank">English</a></li>
    <li><a href="https://cn.costream.site/guide/grammar-book/3.html" class="nav-link" target="_blank">简体中文</a></li>
  </ul>
</li>

<!--<li><a href="https://github.com/vuejs/cn.vuejs.org/" target="_blank" class="nav-link contribute">参与翻译</a></li>-->

    </ul>
    <div class="list">
      
      
        <h2>
          
          Guide
<!--
          
            <select class="version-select">
              <option value="SELF" selected>2.x</option>
              <option value="v1">1.0</option>
              <option value="012">0.12</option>
              <option value="011">0.11</option>
            </select>
          
-->
        </h2>
        <ul class="menu-root">
  
    
    
      
        <li><h3>Essentials</h3></li>
      
      
			
    
    
    <li>
      <a href="/guide/index.html" class="sidebar-link">Introduction</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/installation.html" class="sidebar-link">Installation</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/helloworld.html" class="sidebar-link">Try to run</a>
    </li>
  
    
    
      
      
      <li><h3>Grammar Book</h3></li>
      
			
    
    
    <li>
      <a href="/guide/grammar-book/grammar.html" class="sidebar-link">Grammer Introduction</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/grammar-book/2.html" class="sidebar-link">Keyword & Type</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/grammar-book/3.html" class="sidebar-link current">Streaming Data Process</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/grammar-book/4.html" class="sidebar-link">Make Hierarchical Stream Program</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/grammar-book/5.html" class="sidebar-link">Inside Composite</a>
    </li>
  
    
    
      
      
			
    
    
    <li>
      <a href="/guide/grammar-book/Structure of Program.html" class="sidebar-link">Structure of Program</a>
    </li>
  
    
    
      
      
			
      <li><h3>Else</h3></li>
      
    
    
    <li>
      <a href="/guide/team.html" class="sidebar-link">Team Members</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>


<div class="content guide with-sidebar 3-guide">
  
    
  
  
    <h1>Streaming Data Process</h1>
  
  
    <h2 id="Operator-definition"><a href="#Operator-definition" class="headerlink" title="Operator definition"></a><code>Operator</code> definition</h2><p>The most basic computing unit in <strong>COStream</strong> is <code>operator</code>, which represents a computing node in the data flow graph. The <code>operator</code> defines the input stream and the output stream of the <code>actor</code>, and specific computational processing.</p>
<p>As shown in the following code, the <code>operator</code> consists of a <strong>header definition</strong> and a <strong>body definition</strong>. The <code>operator</code> defines the input and output streams for processing. The <code>operator</code> body includes variable declarations and definitions, <code>init</code>, <code>work</code>, and <code>window</code>. The <code>work</code> is necessary while the rest is optional.<br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">stream&lt;<span class="keyword">int</span> i&gt;S;</span><br><span class="line">S = Source()&#123;</span><br><span class="line">    <span class="comment">//variable declarations and definitions</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y=<span class="number">3</span>;</span><br><span class="line">    <span class="comment">//init</span></span><br><span class="line">    init&#123;</span><br><span class="line">        x=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//work</span></span><br><span class="line">    work&#123;</span><br><span class="line">        s[<span class="number">0</span>].i=x;</span><br><span class="line">        x++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//window</span></span><br><span class="line">    window&#123;</span><br><span class="line">        <span class="function">S <span class="title">tumbling</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Similar to the <strong>C</strong> language’s functional syntax, each <code>operator</code> consists of a <em>header</em> and a <em>body</em> part, and its BNF can be expressed as:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opInvoke ::= opInvokeHeadop InvokeBody</span><br></pre></td></tr></table></figure></p>
<h3 id="1-operator-head-definition"><a href="#1-operator-head-definition" class="headerlink" title="1.operator head definition"></a>1.operator head definition</h3><p>The head <em>opInvokeHead</em> defines the name of the <code>operator</code> and the input and output stream that the <code>operator</code> uses for calculation and communication. The BNF is expressed as:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opInvokeHead    ::= opOutputs ‘=’ ID opInputs | ID opInputs</span><br><span class="line">opOutputs	  ::= streamID |‘(’ streamID+, ‘)’</span><br><span class="line">opInputs	  ::= streamID |‘(’ streamID +, ‘)’</span><br><span class="line">streamID	  ::= streamType ID | ID</span><br></pre></td></tr></table></figure></p>
<p>For example, the <em>Aveverer</em> described above has an input stream of <strong>S</strong> and an output stream of <strong>P</strong>. The complete header is represented as:<br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">P = Averager(S)&#123; <span class="comment">// opInvokeHead</span></span><br><span class="line">                  …<span class="comment">// opInvokeBody</span></span><br><span class="line">               &#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Multiple input and multiple output operator support<br>Different from <strong>StreamIt</strong>, in addition to single-input and single-output streams, <strong>COStream</strong>‘s <code>operator</code> also supports &gt;multiple input and multiple output of stream. The specific usage is as follows:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(O1,O2,O3,O4,O5) = MyOperator(IN1,IN2,IN3,IN4,IN5)</span><br><span class="line">&#123;</span><br><span class="line">…</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>Multiple output streams must be defined separately and enclosed in <code>( )</code>; similarly, multiple input stream are also defined separately.</p>
<h3 id="2-Operator-body-definition"><a href="#2-Operator-body-definition" class="headerlink" title="2.Operator body definition"></a>2.Operator body definition</h3><p>The main part of the <code>operator</code> is contained in <code>{</code> and <code>}</code>, which defines the specific operation process of the <code>operator</code>. Its BNF representation is as follows:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opInvokeBody ::=  &apos;&#123;&apos;</span><br><span class="line">                    ( declaration+ ) *</span><br><span class="line">                    ( ‘init’ opInvokeInitWork+) ?</span><br><span class="line">                    ( ‘work’ opInvokeInitWork+)</span><br><span class="line">                    ( ‘window’ opInvokeWindow+) ?</span><br><span class="line">                  &apos;&#125;&apos;</span><br><span class="line">opInvokeInitWork ::= stmt</span><br><span class="line">opInvokeWindow ::=  &apos;&#123;&apos;</span><br><span class="line">                      opInvokeWindowBody? ;</span><br><span class="line">                    &apos;&#125;&apos;</span><br><span class="line">opInvokeWindowBody ::=  ID ‘sliding’  &apos;(&apos; (expr ‘,‘ expr)? &apos;)&apos;</span><br><span class="line">                      | ID ‘tumbling&apos; &apos;(&apos; expr? &apos;)&apos;</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>
<p>The body of the <code>operator</code> includes the declaration and definition of variables, <code>init</code>, <code>work</code>, and <code>window</code>. <code>work</code> is required, and the rest is optional.</p>
<h2 id="Variable-declaration-and-definition"><a href="#Variable-declaration-and-definition" class="headerlink" title="Variable declaration and definition"></a>Variable declaration and definition</h2><p>Variable declarations and definitions are similar to the <strong>C</strong> language’s static grammar. These declared variables are static variables within the <code>operator</code>.</p>
<blockquote>
<p><strong>The scope of the declared variable in state:</strong><br>The variables in <em>state</em> can be accessed by statements in the <code>init</code> function and the <code>work</code> function, and the scope is the entire <code>operator</code>. </p>
</blockquote>
<h2 id="init-work-window-and-stream"><a href="#init-work-window-and-stream" class="headerlink" title="init, work, window and stream"></a>init, work, window and stream</h2><h3 id="1-init"><a href="#1-init" class="headerlink" title="1.init"></a>1.init</h3><p>The <code>init</code> function represents the  <code>operator</code>‘s initialization process, which is a block statement that can contain any programmer-defined variable declarations and statements, and is executed only when the <code>operator</code> is first executed.</p>
<h3 id="2-work"><a href="#2-work" class="headerlink" title="2. work"></a>2. work</h3><p>The <code>work</code> function represents the most fine-grained operation part of the <code>operator</code>. It is a block statement and can contain any programmer-defined variable declarations and statements. It is the core structure of the <code>operator</code> and the execution unit of each calculation in the steady-state execution of the data flow program. The <code>work</code> function contains operations on the  input stream and output stream of the <code>operator</code>.</p>
<h3 id="3-window"><a href="#3-window" class="headerlink" title="3. window"></a>3. window</h3><p>The <code>window</code> structure specifies type and size of the input stream and output stream used for each execution of the <code>work</code> function. There are two types of windows: <code>sliding</code> and <code>tumbling</code>.</p>
<p><code>Sliding</code> represents the type of sliding window. This window type has two parameters. The first specifies the length of the sliding window. The second specifies the distance for each sliding. The unit is the number of data items in the data stream. For example, <code>S sliding(10,1);</code> indicates that a sliding window is defined on the stream <strong>S</strong>, and the length is 10 data items. After each execution of the <code>work</code> function, the length of one data item is swept backward.</p>
<p><code>Tumbling</code> represents the flip window type. This window takes only one parameter and specifies the window length. For example, <code>T tumbling (10);</code> indicates that a tumbling window is defined on the stream <strong>T</strong>, and the window length is 10 data items. After each execution of the <code>work</code> function, 10 data in the window are cleared. For the input stream, it means that 10 data is consumed, and the subsequent data in the input stream will enter the window; for the output stream, it means that the generated data has filled the window and will be all output to the output stream, and the subsequent generated data will be continuing to fill the window.</p>
<p>In general, <code>sliding</code> window is often used for input stream, and <code>tumbling</code> window is often used for output stream.</p>
<blockquote>
<p><strong>Work function is executed by window trigger mechanism:</strong><br>That is, the <code>work</code> function will only execute when the data fills the window, otherwise the <code>operator</code> will wait until there is enough data.</p>
</blockquote>
<h3 id="4-Streaming-data-access"><a href="#4-Streaming-data-access" class="headerlink" title="4. Streaming data access"></a>4. Streaming data access</h3><p>The <code>operator</code> input stream and output stream data can only be accessed in the <em>work</em> function. </p>
<p>For each component of the stream data item, an access method similar to the structure component in the <strong>C</strong> language is used, which is implemented by taking the <code>.</code> operation of the component. For example, we use <code>stream&lt;int x, int y&gt; S;</code> to define a stream,then <code>S[0].x</code> represents the x component in the data item with the subscript 0 in the <code>window</code> of <strong>S</strong>.</p>

  
  
    <div class="guide-links">
      
      
        <span>← <a href="/guide/grammar-book/2.html">Keyword & Type</a></span>
      
      
      
        <span style="float: right;"><a href="/guide/grammar-book/4.html">Make Hierarchical Stream Program</a> →</span>
      
    </div>
  
  <div class="footer">
	Caught a mistake or want to contribute to the documentation? 
    	
	  <a href="https://github.com/DML308/costream.org/tree/master/src/guide/grammar-book/3.md" target="_blank">
		  Edit this page on GitHub!
	  </a>
  	
  </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>

    <!-- search -->
    <link href="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/search.css">
    <script src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
    [
      '#search-query-nav',
      '#search-query-sidebar',
      '#search-query-menu'
    ].forEach(function (selector) {
      if (!document.querySelector(selector)) return
      // search index defaults to v2
      var match = window.location.pathname.match(/^\/(v\d+)/)
      var version = match ? match[1] : 'v2'
      docsearch({
      appId: 'BH4D9OD16A',
      apiKey: '5638280abff9d207417bb03be05f0b25',
      indexName: 'vuejs_cn2',
      inputSelector: selector,
      algoliaOptions: { facetFilters: ["version:" + version] }
      })
    })
    </script>

    <!-- fastclick -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
    </script>
  </body>
</html>
